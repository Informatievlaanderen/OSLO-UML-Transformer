"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.AppRunner = void 0;
const process_1 = require("process");
const LogUtil_1 = require("../logging/LogUtil");
const ServiceIdentifier_1 = require("../ServiceIdentifier");
class AppRunner {
    runCliSync(process) {
        this.runCli(process.argv).catch((error) => {
            process_1.stderr.write(error.message);
            // eslint-disable-next-line unicorn/no-process-exit
            process.exit(1);
        });
    }
    async startApp(params, container) {
        const configuration = container.get(ServiceIdentifier_1.ServiceIdentifier.Configuration);
        await configuration.createFromCli(params);
        (0, LogUtil_1.setLoggerFactory)(params);
        container.bind(ServiceIdentifier_1.ServiceIdentifier.Logger).toDynamicValue(() => (0, LogUtil_1.createLogger)()).inSingletonScope();
        const service = container.get(ServiceIdentifier_1.ServiceIdentifier.Service);
        service.init()
            .then(() => service.run())
            .catch(error => console.error(error));
    }
}
exports.AppRunner = AppRunner;
//# sourceMappingURL=AppRunner.js.map