{"version":3,"file":"ActorRdfParseHtmlRdfa.js","sourceRoot":"","sources":["ActorRdfParseHtmlRdfa.ts"],"names":[],"mappings":";;;AAEA,qEAAiE;AAEjE,iEAAmD;AAEnD;;GAEG;AACH,MAAa,qBAAsB,SAAQ,sCAAiB;IAC1D,YAAmB,IAA4B;QAC7C,KAAK,CAAC,IAAI,CAAC,CAAC;IACd,CAAC;IAEM,KAAK,CAAC,IAAI,CAAC,MAA2B;QAC3C,OAAO,IAAI,CAAC;IACd,CAAC;IAEM,KAAK,CAAC,GAAG,CAAC,MAA2B;QAC1C,MAAM,SAAS,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QAC7E,MAAM,QAAQ,GAAG,CAAC,MAAM,CAAC,OAAO,IAAI,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,IAAI,SAAS,CAAC;QACzF,MAAM,OAAO,GAAG,SAAS,IAAI,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC;QAE1E,MAAM,iBAAiB,GAAG,IAAI,kCAAU,CAAC,EAAE,OAAO,EAAE,MAAM,CAAC,OAAO,EAAE,OAAO,EAAE,QAAQ,EAAE,CAAC,CAAC;QACzF,iBAAiB,CAAC,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC;QAC5C,iBAAiB,CAAC,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC,IAAI,CAAC,CAAC;QAC1C,6DAA6D;QAC7D,MAAM,WAAW,GAAG,iBAAiB,CAAC,KAAK,CAAC;QAC5C,iBAAiB,CAAC,KAAK,GAAG,GAAG,EAAE;YAC7B,WAAW,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;YACpC,MAAM,CAAC,GAAG,EAAE,CAAC;QACf,CAAC,CAAC;QACF,OAAO,EAAE,iBAAiB,EAAE,CAAC;IAC/B,CAAC;CACF;AAzBD,sDAyBC","sourcesContent":["import type { IActionRdfParseHtml, IActorRdfParseHtmlOutput,\n  IActorRdfParseHtmlArgs } from '@comunica/bus-rdf-parse-html';\nimport { ActorRdfParseHtml } from '@comunica/bus-rdf-parse-html';\nimport type { IActorTest } from '@comunica/core';\nimport { RdfaParser } from 'rdfa-streaming-parser';\n\n/**\n * A comunica RDFa RDF Parse Html Actor.\n */\nexport class ActorRdfParseHtmlRdfa extends ActorRdfParseHtml {\n  public constructor(args: IActorRdfParseHtmlArgs) {\n    super(args);\n  }\n\n  public async test(action: IActionRdfParseHtml): Promise<IActorTest> {\n    return true;\n  }\n\n  public async run(action: IActionRdfParseHtml): Promise<IActorRdfParseHtmlOutput> {\n    const mediaType = action.headers ? action.headers.get('content-type') : null;\n    const language = (action.headers && action.headers.get('content-language')) ?? undefined;\n    const profile = mediaType && mediaType.includes('xml') ? 'xhtml' : 'html';\n\n    const htmlParseListener = new RdfaParser({ baseIRI: action.baseIRI, profile, language });\n    htmlParseListener.on('error', action.error);\n    htmlParseListener.on('data', action.emit);\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    const onTagEndOld = htmlParseListener.onEnd;\n    htmlParseListener.onEnd = () => {\n      onTagEndOld.call(htmlParseListener);\n      action.end();\n    };\n    return { htmlParseListener };\n  }\n}\n"]}